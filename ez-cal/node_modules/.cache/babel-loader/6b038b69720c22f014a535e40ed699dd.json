{"ast":null,"code":"import _slicedToArray from\"/Users/boyuwang/Documents/GitHub/travis/ez-cal/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _classCallCheck from\"/Users/boyuwang/Documents/GitHub/travis/ez-cal/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/boyuwang/Documents/GitHub/travis/ez-cal/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/boyuwang/Documents/GitHub/travis/ez-cal/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/boyuwang/Documents/GitHub/travis/ez-cal/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _assertThisInitialized from\"/Users/boyuwang/Documents/GitHub/travis/ez-cal/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/boyuwang/Documents/GitHub/travis/ez-cal/node_modules/@babel/runtime/helpers/esm/inherits\";import{db}from'./firebase';import{subTimes,times}from'./constants';import React,{Component}from'react';import LinkGenerator from\"./LinkGenerator\";import{Switch,Route}from'react-router-dom';import Addevents from\"./newaddevent\";var Config=require(\"./data/apiGoogleconfig.json\");var ApiCalendar=/*#__PURE__*/function(_Component){_inherits(ApiCalendar,_Component);function ApiCalendar(props){var _this;_classCallCheck(this,ApiCalendar);_this=_possibleConstructorReturn(this,_getPrototypeOf(ApiCalendar).call(this,props));_this.componentDidMount=function(){var userLink=window.location.pathname.substring(1);if(userLink){db.child(userLink).child(\"userName\").once('value',_this.printUserName,function(error){return alert(error);});db.child(userLink).child(\"calID\").once('value',_this.setOtherID,function(error){return alert(error);});db.child(userLink).child(\"events\").once('value',_this.handleData,function(error){return alert(error);});}};_this.printUserName=function(snap){if(snap.val()){_this.setState({otherUser:snap.val()});}};_this.setOtherID=function(snap){if(snap.val()){_this.setState({otherCalID:snap.val()});}};_this.handleData=function(snap){if(snap.val()){if(_this.state.otherUser){_this.setBusy2(Object.values(snap.val(),_this.state.otherUser));}}};_this.checkLastDay=function(month,year){var numberOfDays;if(month==4||month==6||month==9||month==11)numberOfDays=30;else if(month==2){var isLeapYear=function isLeapYear(year){return year%4==0&&year%100!=0||year%400==0;};if(isLeapYear(year))numberOfDays=29;else numberOfDays=28;}else numberOfDays=31;return numberOfDays;};_this.buildDayList=function(){var date=new Date();var numberOfDays=_this.checkLastDay(date.getMonth()+1,date.getFullYear());var weekDays=[\"Su\",\"M\",\"Tu\",\"W\",\"Th\",\"F\",\"Sa\"];var dayList=[],dateList=[];for(var i=0;i<7;i++){dayList.push(weekDays[(date.getDay()+i)%7]);if(date.getDate()+i>numberOfDays){dateList.push((date.getDate()+i)%numberOfDays);}else{dateList.push(date.getDate()+i);}}return[dayList,dateList];};_this.dayGrid=function(){var _this$buildDayList=_this.buildDayList(),_this$buildDayList2=_slicedToArray(_this$buildDayList,2),days=_this$buildDayList2[0],dates=_this$buildDayList2[1];var realTimes=subTimes.slice(0,subTimes.length-1);var timeBlock=realTimes.map(function(x){return x.split(\":\")[1]===\"00\"?React.createElement(\"div\",{className:\"dayTime\"},x):React.createElement(\"div\",{className:\"dayTime\"});});var cal=[];cal.push(React.createElement(\"div\",{className:\"dayCol\"},React.createElement(\"div\",{className:\"dayEmpty\"}),timeBlock));for(var i=0;i<days.length;i++){var hours=[];for(var j=0;j<subTimes.length;j++){if(subTimes[j]===\"0:00\"){hours.push(React.createElement(\"div\",{id:\"\".concat(dates[i],\" \").concat(subTimes[j]),styles:{display:\"hidden\"}}));}else if(times.includes(subTimes[j])){hours.push(React.createElement(\"div\",{id:\"\".concat(dates[i],\" \").concat(subTimes[j]),className:\"dayHour\"}));}else{hours.push(React.createElement(\"div\",{id:\"\".concat(dates[i],\" \").concat(subTimes[j]),className:\"daySubHour\"}));}}cal.push(React.createElement(\"div\",{className:\"dayCol\"},React.createElement(\"div\",{className:\"dayHead\"},days[i],React.createElement(\"div\",{className:\"dayDate\"},dates[i])),hours));}return React.createElement(\"div\",{className:\"dayWrapper\"},cal);};_this.SharedCalendar=function(){return React.createElement(\"div\",null,_this.dayGrid());};_this.MyCalendar=function(){return React.createElement(\"div\",null,_this.dayGrid());};_this.Main=function(){return React.createElement(Switch,null,React.createElement(Route,{exact:true,path:\"/\",component:_this.MyCalendar}),React.createElement(Route,{path:window.location.pathname,component:_this.SharedCalendar}));};_this.setLink=function(uid){return window.location.href+uid;};_this.showEvents=function(){var googleEvents;if(_this.sign)_this.listUpcomingEvents().then(function(_ref){var result=_ref.result;googleEvents=result.items;_this.setState({uid:_this.getUserID(),userName:_this.getUserName()});db.child(_this.getUserID()).child('events').set(googleEvents);db.child(_this.getUserID()).child('userName').set(_this.getUserName());db.child(_this.getUserID()).child('calID').set(_this.getEmail());_this.setBusy(googleEvents);});};_this.setBusy=function(events){var userLink=window.location.pathname.substring(1);if(!userLink){for(var i=0;i<events.length;i++){if(!events[i].start.dateTime){continue;}var date=events[i].start.dateTime.substring(8,10);if(date.substring(0,1)==='0'){date=date.substring(1);}var start=events[i].start.dateTime.substring(11,16);var end=events[i].end.dateTime.substring(11,16);if(start.substring(0,1)==='0'){start=start.substring(1);}if(end.substring(0,1)==='0'){end=end.substring(1);}var startIndex=subTimes.indexOf(start);var endIndex=subTimes.indexOf(end);for(var j=startIndex;j<endIndex;j++){var nextEvent=document.getElementById(\"\".concat(date,\" \").concat(subTimes[j]));if(nextEvent.className.includes(\"Busy\")){continue;}else{nextEvent.className+=\"Busy\";}}}}else if(userLink&&_this.state.uid){for(var _i=0;_i<events.length;_i++){if(!events[_i].start.dateTime){continue;}var _date=events[_i].start.dateTime.substring(8,10);if(_date.substring(0,1)==='0'){_date=_date.substring(1);}var _start=events[_i].start.dateTime.substring(11,16);var _end=events[_i].end.dateTime.substring(11,16);if(_start.substring(0,1)==='0'){_start=_start.substring(1);}if(_end.substring(0,1)==='0'){_end=_end.substring(1);}var _startIndex=subTimes.indexOf(_start);var _endIndex=subTimes.indexOf(_end);for(var _j=_startIndex;_j<_endIndex;_j++){var _nextEvent=document.getElementById(\"\".concat(_date,\" \").concat(subTimes[_j]));if(_nextEvent.className.includes(\"FriendBusy\")){if(_nextEvent.className.includes(\"Sub\")){_nextEvent.className=\"daySubHourOverlapBusy\";}else{_nextEvent.className=\"dayHourOverlapBusy\";}}else{_nextEvent.className+=\"Busy\";}}}}};_this.setBusy2=function(events,userName){for(var i=0;i<events.length;i++){var date=events[i].start.dateTime.substring(8,10);if(date.substring(0,1)==='0'){date=date.substring(1);}var today=new Date().getDate();if(date>=today){var start=events[i].start.dateTime.substring(11,16);var end=events[i].end.dateTime.substring(11,16);if(start.substring(0,1)==='0'){start=start.substring(1);}if(end.substring(0,1)==='0'){end=end.substring(1);}var startIndex=subTimes.indexOf(start);var endIndex=subTimes.indexOf(end);for(var j=startIndex;j<endIndex;j++){var nextEvent=document.getElementById(\"\".concat(date,\" \").concat(subTimes[j]));if(nextEvent.className.includes(\"Busy\")){continue;}else{// if (j === startIndex) {\n//   nextEvent.innerHTML = this.state.otherUser;\n// }\nnextEvent.className+=\"FriendBusy\";}}}}};_this.setFree=function(){var x;while(document.getElementsByClassName(\"dayHourBusy\").length>0){x=document.getElementsByClassName(\"dayHourBusy\")[0];x.className=\"dayHour\";x.innerHTML=\"\";}var y;while(document.getElementsByClassName(\"daySubHourBusy\").length>0){y=document.getElementsByClassName(\"daySubHourBusy\")[0];y.className=\"daySubHour\";y.innerHTML=\"\";}var a;while(document.getElementsByClassName(\"dayHourFriendBusy\").length>0){a=document.getElementsByClassName(\"dayHourFriendBusy\")[0];a.className=\"dayHour\";a.innerHTML=\"\";}var b;while(document.getElementsByClassName(\"daySubHourFriendBusy\").length>0){b=document.getElementsByClassName(\"daySubHourFriendBusy\")[0];b.className=\"daySubHour\";b.innerHTML=\"\";}var c;while(document.getElementsByClassName(\"daySubHourOverlapBusy\").length>0){c=document.getElementsByClassName(\"daySubHourOverlapBusy\")[0];c.className=\"dayHour\";c.innerHTML=\"\";}var d;while(document.getElementsByClassName(\"dayHourOverlapBusy\").length>0){d=document.getElementsByClassName(\"dayHourOverlapBusy\")[0];d.className=\"daySubHour\";d.innerHTML=\"\";}};_this.Login=function(){_this.handleAuthClick();};_this.Logout=function(){_this.handleSignoutClick();_this.setState({uid:null,userName:null});};_this.state={uid:null,userName:null,otherUser:null,otherCalID:null};_this.sign=false;_this.gapi=null;_this.onLoadCallback=null;_this.calendar='primary';try{_this.updateSigninStatus=_this.updateSigninStatus.bind(_assertThisInitialized(_this));_this.initClient=_this.initClient.bind(_assertThisInitialized(_this));_this.handleSignoutClick=_this.handleSignoutClick.bind(_assertThisInitialized(_this));_this.handleAuthClick=_this.handleAuthClick.bind(_assertThisInitialized(_this));_this.createEvent=_this.createEvent.bind(_assertThisInitialized(_this));_this.listUpcomingEvents=_this.listUpcomingEvents.bind(_assertThisInitialized(_this));_this.createEventFromNow=_this.createEventFromNow.bind(_assertThisInitialized(_this));_this.listenSign=_this.listenSign.bind(_assertThisInitialized(_this));_this.onLoad=_this.onLoad.bind(_assertThisInitialized(_this));_this.setCalendar=_this.setCalendar.bind(_assertThisInitialized(_this));_this.handleClientLoad();_this.testcreateEvent=_this.testcreateEvent.bind(_assertThisInitialized(_this));}catch(e){console.log(e);}return _this;}_createClass(ApiCalendar,[{key:\"updateSigninStatus\",value:function updateSigninStatus(isSignedIn){this.sign=isSignedIn;if(this.getUserID()){this.showEvents();}}/**\n   * Auth to the google Api.\n   */},{key:\"initClient\",value:function initClient(){var _this2=this;this.gapi=window['gapi'];this.gapi.client.init(Config).then(function(){// Listen for sign-in state changes.\n_this2.gapi.auth2.getAuthInstance().isSignedIn.listen(_this2.updateSigninStatus);// Handle the initial sign-in state.\n_this2.updateSigninStatus(_this2.gapi.auth2.getAuthInstance().isSignedIn.get());if(_this2.onLoadCallback){_this2.onLoadCallback();}}).catch(function(e){console.log(e);});}/**\n   * Init Google Api\n   * And create gapi in global\n   */},{key:\"handleClientLoad\",value:function handleClientLoad(){var _this3=this;this.gapi=window['gapi'];var script=document.createElement(\"script\");script.src=\"https://apis.google.com/js/api.js\";document.body.appendChild(script);script.onload=function(){window['gapi'].load('client:auth2',_this3.initClient);};}},{key:\"getUserID\",value:function getUserID(){return this.gapi.auth2.getAuthInstance().currentUser['Ab']['El'];}},{key:\"getUserName\",value:function getUserName(){return this.gapi.auth2.getAuthInstance().currentUser['Ab']['w3']['ig'];}},{key:\"getEmail\",value:function getEmail(){return this.gapi.auth2.getAuthInstance().currentUser.Ab.w3.U3;}/**\n   * Sign in Google user account\n   */},{key:\"handleAuthClick\",value:function handleAuthClick(){if(this.gapi){this.gapi.auth2.getAuthInstance().signIn();}else{console.log(\"Error: this.gapi not loaded\");}}/**\n   * Set the default attribute calendar\n   * @param {string} newCalendar\n   */},{key:\"setCalendar\",value:function setCalendar(newCalendar){this.calendar=newCalendar;}/**\n   * Execute the callback function when a user is disconnected or connected with the sign status.\n   * @param callback\n   */},{key:\"listenSign\",value:function listenSign(callback){if(this.gapi){this.gapi.auth2.getAuthInstance().isSignedIn.listen(callback);}else{console.log(\"Error: this.gapi not loaded\");}}/**\n   * Execute the callback function when gapi is loaded\n   * @param callback\n   */},{key:\"onLoad\",value:function onLoad(callback){if(this.gapi){callback();}else{this.onLoadCallback=callback;}}/**\n   * Sign out user google account\n   */},{key:\"handleSignoutClick\",value:function handleSignoutClick(){if(this.gapi){this.gapi.auth2.getAuthInstance().signOut();this.setFree();var userLink=window.location.pathname.substring(1);if(userLink){db.child(userLink).child(\"events\").once('value',this.handleData,function(error){return alert(error);});}}else{console.log(\"Error: this.gapi not loaded\");}}/**\n   * List all events in the calendar\n   * @param {number} maxResults to see\n   * @param {string} calendarId to see by default use the calendar attribute\n   * @returns {any}\n   */},{key:\"listUpcomingEvents\",value:function listUpcomingEvents(){var calendarId=arguments.length>0&&arguments[0]!==undefined?arguments[0]:this.calendar;if(this.gapi){var d=new Date();d.setDate(d.getDate()+7);return this.gapi.client.calendar.events.list({'calendarId':calendarId,'timeMin':new Date().toISOString(),'timeMax':d.toISOString(),'showDeleted':false,'singleEvents':true,'orderBy':'startTime'});}else{console.log(\"Error: this.gapi not loaded\");return false;}}/**\n   * Create an event from the current time for a certain period\n   * @param {number} time in minutes for the event\n   * @param {string} summary of the event\n   * @param {string} description of the event\n   * @param {string} calendarId\n   * @returns {any}\n   */},{key:\"createEventFromNow\",value:function createEventFromNow(_ref2){var time=_ref2.time,summary=_ref2.summary,_ref2$description=_ref2.description,description=_ref2$description===void 0?'':_ref2$description;var calendarId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.calendar;var event={summary:summary,description:description,start:{dateTime:new Date().toISOString(),timeZone:\"Europe/Paris\"},end:{dateTime:new Date(new Date().getTime()+time*60000),timeZone:\"Europe/Paris\"}};return this.gapi.client.calendar.events.insert({'calendarId':calendarId,'resource':event});}/**\n   * Create Calendar event\n   * @param {string} calendarId for the event.\n   * @param {object} event with start and end dateTime\n   * @returns {any}\n   */},{key:\"createEvent\",value:function createEvent(event){var calendarId=arguments.length>1&&arguments[1]!==undefined?arguments[1]:this.calendar;return this.gapi.client.calendar.events.insert({'calendarId':calendarId,'resource':event});}},{key:\"testcreateEvent\",value:function testcreateEvent(event,starttime,endtime){var attendees=this.state.otherCalID?[{\"email\":this.state.otherCalID}]:[];var uploadevent={'summary':event,'description':'','start':{'dateTime':starttime,'timeZone':'America/Chicago'},'end':{'dateTime':endtime,'timeZone':'America/Chicago'},'attendees':attendees};var request=this.gapi.client.calendar.events.insert({'calendarId':this.calendar,'resource':uploadevent});request.execute();window.location.reload();}},{key:\"render\",value:function render(){var _this4=this;return React.createElement(\"div\",null,this.state.uid?React.createElement(\"button\",{onClick:function onClick(){return _this4.Logout();}},\"Sign out\"):null,this.state.uid?React.createElement(\"div\",null,\"Welcome, \",this.state.userName,\"!\"):React.createElement(\"button\",{onClick:function onClick(){_this4.Login();}},\"Sync with Google\"),this.state.userName&&!this.state.otherUser?React.createElement(LinkGenerator,{link:this.setLink(this.state.uid)}):null,React.createElement(Addevents,{createEvent:this.testcreateEvent}),this.Main());}}]);return ApiCalendar;}(Component);export{ApiCalendar as default};var apiCalendar;try{apiCalendar=new ApiCalendar();}catch(e){console.log(e);}","map":{"version":3,"sources":["/Users/boyuwang/Documents/GitHub/travis/ez-cal/src/ApiCalendar.js"],"names":["db","subTimes","times","React","Component","LinkGenerator","Switch","Route","Addevents","Config","require","ApiCalendar","props","componentDidMount","userLink","window","location","pathname","substring","child","once","printUserName","error","alert","setOtherID","handleData","snap","val","setState","otherUser","otherCalID","state","setBusy2","Object","values","checkLastDay","month","year","numberOfDays","isLeapYear","buildDayList","date","Date","getMonth","getFullYear","weekDays","dayList","dateList","i","push","getDay","getDate","dayGrid","days","dates","realTimes","slice","length","timeBlock","map","x","split","cal","hours","j","display","includes","SharedCalendar","MyCalendar","Main","setLink","uid","href","showEvents","googleEvents","sign","listUpcomingEvents","then","result","items","getUserID","userName","getUserName","set","getEmail","setBusy","events","start","dateTime","end","startIndex","indexOf","endIndex","nextEvent","document","getElementById","className","today","setFree","getElementsByClassName","innerHTML","y","a","b","c","d","Login","handleAuthClick","Logout","handleSignoutClick","gapi","onLoadCallback","calendar","updateSigninStatus","bind","initClient","createEvent","createEventFromNow","listenSign","onLoad","setCalendar","handleClientLoad","testcreateEvent","e","console","log","isSignedIn","client","init","auth2","getAuthInstance","listen","get","catch","script","createElement","src","body","appendChild","onload","load","currentUser","Ab","w3","U3","signIn","newCalendar","callback","signOut","calendarId","setDate","list","toISOString","time","summary","description","event","timeZone","getTime","insert","starttime","endtime","attendees","uploadevent","request","execute","reload","apiCalendar"],"mappings":"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","sourcesContent":["import { db } from './firebase';\nimport { subTimes, times } from './constants';\nimport React, { Component } from 'react';\nimport LinkGenerator from \"./LinkGenerator\";\nimport { Switch, Route } from 'react-router-dom'\nimport Addevents from \"./newaddevent\";\nconst Config = require(\"./data/apiGoogleconfig.json\");\n\nexport default class ApiCalendar extends Component {\n\n  static propTypes = {\n    uid: null,\n    name: null\n  }\n  constructor(props) {\n    super(props);\n    this.state = {\n      uid: null,\n      userName: null,\n      otherUser: null,\n      otherCalID: null\n    }\n    this.sign = false;\n    this.gapi = null;\n    this.onLoadCallback = null;\n    this.calendar = 'primary';\n    try {\n      this.updateSigninStatus = this.updateSigninStatus.bind(this);\n      this.initClient = this.initClient.bind(this);\n      this.handleSignoutClick = this.handleSignoutClick.bind(this);\n      this.handleAuthClick = this.handleAuthClick.bind(this);\n      this.createEvent = this.createEvent.bind(this);\n      this.listUpcomingEvents = this.listUpcomingEvents.bind(this);\n      this.createEventFromNow = this.createEventFromNow.bind(this);\n      this.listenSign = this.listenSign.bind(this);\n      this.onLoad = this.onLoad.bind(this);\n      this.setCalendar = this.setCalendar.bind(this);\n      this.handleClientLoad();\n      this.testcreateEvent = this.testcreateEvent.bind(this);\n    }\n    catch (e) {\n      console.log(e);\n    }\n  }\n\n  componentDidMount = () => {\n    const userLink = window.location.pathname.substring(1);\n    if (userLink) {\n      db.child(userLink).child(\"userName\").once('value', this.printUserName, error => alert(error));\n      db.child(userLink).child(\"calID\").once('value', this.setOtherID, error => alert(error));\n      db.child(userLink).child(\"events\").once('value', this.handleData, error => alert(error));\n    }\n  };\n\n  printUserName = (snap) => {\n    if (snap.val()) {\n      this.setState({\n        otherUser: snap.val(),\n      })\n    }\n  }\n\n  setOtherID = (snap) => {\n    if (snap.val()) {\n      this.setState({\n        otherCalID: snap.val()\n      })\n    }\n  }\n\n  handleData = (snap) => {\n    if (snap.val()) {\n      if (this.state.otherUser) {\n        this.setBusy2(Object.values(snap.val(), this.state.otherUser));\n      }\n    }\n  };\n\n  checkLastDay = (month, year) => {\n    var numberOfDays;\n    if (month == 4 || month == 6 || month == 9 || month == 11)\n      numberOfDays = 30;\n    else if (month == 2) {\n      const isLeapYear = (year) => (year % 4 == 0 && year % 100 != 0) || (year % 400 == 0);\n      if (isLeapYear(year))\n        numberOfDays = 29;\n      else\n        numberOfDays = 28;\n    }\n    else\n      numberOfDays = 31;\n\n    return numberOfDays;\n  }\n\n  buildDayList = () => {\n    let date = new Date();\n    let numberOfDays = this.checkLastDay(date.getMonth() + 1, date.getFullYear());\n    let weekDays = [\"Su\", \"M\", \"Tu\", \"W\", \"Th\", \"F\", \"Sa\"];\n    let dayList = [], dateList = [];\n\n    for (let i = 0; i < 7; i++) {\n      dayList.push(weekDays[(date.getDay() + i) % 7]);\n      if ((date.getDate() + i) > numberOfDays) {\n        dateList.push((date.getDate() + i) % (numberOfDays));\n      }\n      else {\n        dateList.push(date.getDate() + i);\n      }\n    }\n    return [dayList, dateList];\n  };\n\n  dayGrid = () => {\n    let [days, dates] = this.buildDayList();\n    let realTimes = subTimes.slice(0, subTimes.length - 1)\n    let timeBlock = realTimes.map(x => {\n      return x.split(\":\")[1] === \"00\" ? <div className=\"dayTime\">{x}</div> : <div className=\"dayTime\"></div>;\n    });\n\n    let cal = [];\n    cal.push(<div className=\"dayCol\">\n      <div className=\"dayEmpty\"></div>\n      {timeBlock}\n    </div>\n    );\n\n    for (let i = 0; i < days.length; i++) {\n      let hours = [];\n      for (let j = 0; j < subTimes.length; j++) {\n        if (subTimes[j] === \"0:00\") {\n          hours.push(<div id={`${dates[i]} ${subTimes[j]}`} styles={{ display: \"hidden\" }} />);\n        }\n        else if (times.includes(subTimes[j])) {\n          hours.push(<div id={`${dates[i]} ${subTimes[j]}`} className=\"dayHour\" />);\n        }\n        else {\n          hours.push(<div id={`${dates[i]} ${subTimes[j]}`} className=\"daySubHour\" />);\n        }\n      }\n\n      cal.push(<div className=\"dayCol\">\n        <div className=\"dayHead\">{days[i]}\n          <div className=\"dayDate\">{dates[i]}</div>\n        </div>\n        {hours}\n      </div>);\n    }\n\n\n    return (\n      <div className=\"dayWrapper\">\n        {cal}\n      </div>\n    );\n  };\n\n  SharedCalendar = () => {\n    return (\n      <div>\n        {this.dayGrid()}\n      </div>\n    );\n  };\n\n  MyCalendar = () => {\n    return (\n      <div>\n        {this.dayGrid()}\n      </div>\n    );\n  };\n\n  Main = () => {\n    return (\n      <Switch>\n        <Route exact path='/' component={this.MyCalendar} />\n        <Route path={window.location.pathname} component={this.SharedCalendar} />\n      </Switch>\n    );\n  };\n\n  /**\n   * Update connection status.\n   * @param {boolean} isSignedIn\n   */\n\n  setLink = (uid) => {\n    return window.location.href + uid;\n  };\n\n  showEvents = () => {\n    let googleEvents;\n    if (this.sign)\n      this.listUpcomingEvents()\n        .then(({ result }) => {\n          googleEvents = result.items;\n          this.setState({\n            uid: this.getUserID(),\n            userName: this.getUserName(),\n          })\n\n          db.child(this.getUserID()).child('events').set(googleEvents);\n          db.child(this.getUserID()).child('userName').set(this.getUserName());\n          db.child(this.getUserID()).child('calID').set(this.getEmail());\n\n          this.setBusy(googleEvents);\n        });\n  };\n\n  setBusy = (events) => {\n    const userLink = window.location.pathname.substring(1);\n    if (!userLink) {\n      for (let i = 0; i < events.length; i++) {\n\n        if (!events[i].start.dateTime) {\n          continue;\n        }\n        let date = events[i].start.dateTime.substring(8, 10);\n\n        if (date.substring(0, 1) === '0') {\n          date = date.substring(1);\n        }\n\n        let start = events[i].start.dateTime.substring(11, 16);\n        let end = events[i].end.dateTime.substring(11, 16);\n\n        if (start.substring(0, 1) === '0') {\n          start = start.substring(1);\n        }\n\n        if (end.substring(0, 1) === '0') {\n          end = end.substring(1);\n        }\n\n        let startIndex = subTimes.indexOf(start);\n        let endIndex = subTimes.indexOf(end);\n\n        for (let j = startIndex; j < endIndex; j++) {\n          let nextEvent = document.getElementById(`${date} ${subTimes[j]}`);\n          if (nextEvent.className.includes(\"Busy\")) {\n            continue;\n          }\n          else {\n            nextEvent.className += \"Busy\";\n          }\n        }\n      }\n    }\n    else if (userLink && this.state.uid) {\n      for (let i = 0; i < events.length; i++) {\n        if (!events[i].start.dateTime) {\n          continue;\n        }\n        let date = events[i].start.dateTime.substring(8, 10);\n        if (date.substring(0, 1) === '0') {\n          date = date.substring(1);\n        }\n        let start = events[i].start.dateTime.substring(11, 16);\n        let end = events[i].end.dateTime.substring(11, 16);\n\n        if (start.substring(0, 1) === '0') {\n          start = start.substring(1);\n        }\n        if (end.substring(0, 1) === '0') {\n          end = end.substring(1);\n        }\n\n        let startIndex = subTimes.indexOf(start);\n        let endIndex = subTimes.indexOf(end);\n\n        for (let j = startIndex; j < endIndex; j++) {\n          let nextEvent = document.getElementById(`${date} ${subTimes[j]}`);\n          if (nextEvent.className.includes(\"FriendBusy\")) {\n            if (nextEvent.className.includes(\"Sub\")) {\n              nextEvent.className = \"daySubHourOverlapBusy\"\n            }\n            else {\n              nextEvent.className = \"dayHourOverlapBusy\"\n            }\n          }\n          else {\n            nextEvent.className += \"Busy\";\n          }\n        }\n      }\n    }\n  };\n\n  setBusy2 = (events, userName) => {\n    for (let i = 0; i < events.length; i++) {\n      let date = events[i].start.dateTime.substring(8, 10);\n      if (date.substring(0, 1) === '0') {\n        date = date.substring(1);\n      }\n\n      let today = new Date().getDate();\n      if (date >= today) {\n        let start = events[i].start.dateTime.substring(11, 16);\n        let end = events[i].end.dateTime.substring(11, 16);\n\n        if (start.substring(0, 1) === '0') {\n          start = start.substring(1);\n        }\n        if (end.substring(0, 1) === '0') {\n          end = end.substring(1);\n        }\n\n        let startIndex = subTimes.indexOf(start);\n        let endIndex = subTimes.indexOf(end);\n\n        for (let j = startIndex; j < endIndex; j++) {\n          let nextEvent = document.getElementById(`${date} ${subTimes[j]}`);\n          if (nextEvent.className.includes(\"Busy\")) {\n            continue;\n          }\n          else {\n            // if (j === startIndex) {\n            //   nextEvent.innerHTML = this.state.otherUser;\n            // }\n            nextEvent.className += \"FriendBusy\";\n          }\n        }\n      }\n    }\n  }\n\n  setFree = () => {\n    let x;\n    while (document.getElementsByClassName(\"dayHourBusy\").length > 0) {\n      x = document.getElementsByClassName(\"dayHourBusy\")[0]\n      x.className = \"dayHour\"\n      x.innerHTML = \"\"\n    }\n    let y;\n    while (document.getElementsByClassName(\"daySubHourBusy\").length > 0) {\n      y = document.getElementsByClassName(\"daySubHourBusy\")[0]\n      y.className = \"daySubHour\"\n      y.innerHTML = \"\"\n    }\n    let a;\n    while (document.getElementsByClassName(\"dayHourFriendBusy\").length > 0) {\n      a = document.getElementsByClassName(\"dayHourFriendBusy\")[0]\n      a.className = \"dayHour\"\n      a.innerHTML = \"\"\n    }\n    let b;\n    while (document.getElementsByClassName(\"daySubHourFriendBusy\").length > 0) {\n      b = document.getElementsByClassName(\"daySubHourFriendBusy\")[0]\n      b.className = \"daySubHour\"\n      b.innerHTML = \"\"\n    }\n    let c;\n    while (document.getElementsByClassName(\"daySubHourOverlapBusy\").length > 0) {\n      c = document.getElementsByClassName(\"daySubHourOverlapBusy\")[0]\n      c.className = \"dayHour\"\n      c.innerHTML = \"\"\n    }\n    let d;\n    while (document.getElementsByClassName(\"dayHourOverlapBusy\").length > 0) {\n      d = document.getElementsByClassName(\"dayHourOverlapBusy\")[0]\n      d.className = \"daySubHour\"\n      d.innerHTML = \"\"\n    }\n\n  };\n\n\n  updateSigninStatus(isSignedIn) {\n    this.sign = isSignedIn;\n    if (this.getUserID()) {\n      this.showEvents();\n    }\n\n  }\n  /**\n   * Auth to the google Api.\n   */\n  initClient() {\n    this.gapi = window['gapi'];\n    this.gapi.client.init(Config)\n      .then(() => {\n        // Listen for sign-in state changes.\n        this.gapi.auth2.getAuthInstance().isSignedIn.listen(this.updateSigninStatus);\n        // Handle the initial sign-in state.\n        this.updateSigninStatus(this.gapi.auth2.getAuthInstance().isSignedIn.get());\n        if (this.onLoadCallback) {\n          this.onLoadCallback();\n        }\n      })\n      .catch((e) => {\n        console.log(e);\n      });\n  }\n  /**\n   * Init Google Api\n   * And create gapi in global\n   */\n  handleClientLoad() {\n    this.gapi = window['gapi'];\n    const script = document.createElement(\"script\");\n    script.src = \"https://apis.google.com/js/api.js\";\n    document.body.appendChild(script);\n    script.onload = () => {\n      window['gapi'].load('client:auth2', this.initClient);\n    };\n  }\n  getUserID() {\n    return this.gapi.auth2.getAuthInstance().currentUser['Ab']['El'];\n  }\n\n  getUserName() {\n    return this.gapi.auth2.getAuthInstance().currentUser['Ab']['w3']['ig'];\n  }\n\n  getEmail() {\n    return this.gapi.auth2.getAuthInstance().currentUser.Ab.w3.U3;\n  }\n\n  /**\n   * Sign in Google user account\n   */\n  handleAuthClick() {\n    if (this.gapi) {\n      this.gapi.auth2.getAuthInstance().signIn();\n    }\n    else {\n      console.log(\"Error: this.gapi not loaded\");\n    }\n  }\n  /**\n   * Set the default attribute calendar\n   * @param {string} newCalendar\n   */\n  setCalendar(newCalendar) {\n    this.calendar = newCalendar;\n  }\n  /**\n   * Execute the callback function when a user is disconnected or connected with the sign status.\n   * @param callback\n   */\n  listenSign(callback) {\n    if (this.gapi) {\n      this.gapi.auth2.getAuthInstance().isSignedIn.listen(callback);\n    }\n    else {\n      console.log(\"Error: this.gapi not loaded\");\n    }\n  }\n  /**\n   * Execute the callback function when gapi is loaded\n   * @param callback\n   */\n  onLoad(callback) {\n    if (this.gapi) {\n      callback();\n    }\n    else {\n      this.onLoadCallback = callback;\n    }\n  }\n  /**\n   * Sign out user google account\n   */\n  handleSignoutClick() {\n    if (this.gapi) {\n      this.gapi.auth2.getAuthInstance().signOut();\n      this.setFree();\n      const userLink = window.location.pathname.substring(1);\n      if (userLink) {\n        db.child(userLink).child(\"events\").once('value', this.handleData, error => alert(error));\n      }\n    }\n    else {\n      console.log(\"Error: this.gapi not loaded\");\n    }\n  }\n  /**\n   * List all events in the calendar\n   * @param {number} maxResults to see\n   * @param {string} calendarId to see by default use the calendar attribute\n   * @returns {any}\n   */\n  listUpcomingEvents(calendarId = this.calendar) {\n    if (this.gapi) {\n      let d = new Date();\n      d.setDate(d.getDate() + 7);\n      return this.gapi.client.calendar.events.list({\n        'calendarId': calendarId,\n        'timeMin': (new Date()).toISOString(),\n        'timeMax': d.toISOString(),\n        'showDeleted': false,\n        'singleEvents': true,\n        'orderBy': 'startTime'\n      });\n    }\n    else {\n      console.log(\"Error: this.gapi not loaded\");\n      return false;\n    }\n  }\n  /**\n   * Create an event from the current time for a certain period\n   * @param {number} time in minutes for the event\n   * @param {string} summary of the event\n   * @param {string} description of the event\n   * @param {string} calendarId\n   * @returns {any}\n   */\n  createEventFromNow({ time, summary, description = '' }, calendarId = this.calendar) {\n    const event = {\n      summary,\n      description,\n      start: {\n        dateTime: (new Date()).toISOString(),\n        timeZone: \"Europe/Paris\",\n      },\n      end: {\n        dateTime: (new Date(new Date().getTime() + time * 60000)),\n        timeZone: \"Europe/Paris\",\n      }\n    };\n    return this.gapi.client.calendar.events.insert({\n      'calendarId': calendarId,\n      'resource': event,\n    });\n  }\n  /**\n   * Create Calendar event\n   * @param {string} calendarId for the event.\n   * @param {object} event with start and end dateTime\n   * @returns {any}\n   */\n  createEvent(event, calendarId = this.calendar) {\n\n    return this.gapi.client.calendar.events.insert({\n      'calendarId': calendarId,\n      'resource': event,\n    });\n  }\n\n  testcreateEvent(event, starttime, endtime) {\n\n    var attendees = this.state.otherCalID ? [{ \"email\": this.state.otherCalID }] : [];\n\n    var uploadevent = {\n      'summary': event,\n      'description': '',\n      'start': {\n        'dateTime': starttime,\n        'timeZone': 'America/Chicago'\n      },\n      'end': {\n        'dateTime': endtime,\n        'timeZone': 'America/Chicago'\n      },\n      'attendees': attendees\n    };\n\n    var request = this.gapi.client.calendar.events.insert({\n      'calendarId': this.calendar,\n      'resource': uploadevent\n    });\n\n    request.execute();\n\n    window.location.reload();\n  }\n\n\n  Login = () => {\n    this.handleAuthClick();\n  }\n\n  Logout = () => {\n    this.handleSignoutClick();\n    this.setState({\n      uid: null,\n      userName: null,\n    })\n  }\n\n  render() {\n\n    return (\n      <div>\n        {this.state.uid ? <button onClick={() => this.Logout()}>Sign out</button> : null}\n\n        {this.state.uid ? <div>Welcome, {this.state.userName}!</div> : <button onClick={() => { this.Login() }}>Sync with Google</button>}\n        {(this.state.userName && !this.state.otherUser) ? <LinkGenerator link={this.setLink(this.state.uid)} /> : null}\n        <Addevents createEvent={this.testcreateEvent} />\n        {this.Main()}\n      </div>\n    )\n  }\n}\nlet apiCalendar;\ntry {\n  apiCalendar = new ApiCalendar();\n}\ncatch (e) {\n  console.log(e);\n}\n\n\n"]},"metadata":{},"sourceType":"module"}